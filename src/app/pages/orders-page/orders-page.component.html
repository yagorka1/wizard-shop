<div class="flex justify-center p-4 mt-10">
  <p-card class="mb-0 rounded-xl w-full max-w-7xl">
    <ng-template pTemplate="header">
      <div class="flex items-center justify-between w-full p-6">
      <span class="text-xl font-semibold">
        {{ 'orders.title' | translate }}
      </span>

        <a
          routerLink="/order-create"
          class="bg-yellow-400 hover:bg-yellow-500 text-purple-900 font-bold py-2 px-6 rounded-xl shadow-lg transition cursor-pointer"
        >
          {{ 'orders.orderPotion' | translate }}
        </a>
      </div>
    </ng-template>
    <p-toast/>

    <div class="overflow-x-auto touch-pan-x overflow-y-auto max-h-[80vh]">
      <p-table
        [value]="orders"
        dataKey="id"
        [paginator]="orders.length > 0"
        [pageLinks]="3"
        [rows]="8"
        [tableStyle]="{ 'min-width': '60rem' }"
        class="w-full"
      >
        <ng-template #header>
          <tr>
            <th style="width: 5rem"></th>
            <th>{{ 'orders.table.customerName' | translate }}</th>
            <th>{{ 'orders.table.potionNumber' | translate }}</th>
            <th>{{ 'orders.table.orderDate' | translate }}</th>
            <th>{{ 'orders.table.readyDate' | translate }}</th>
            <th>{{ 'orders.table.address' | translate }}</th>
            <th>{{ 'orders.table.delivery' | translate }}</th>
            <th>{{ 'orders.table.payment' | translate }}</th>
            <th>{{ 'orders.table.price' | translate }}</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="9" class="text-center py-6 text-gray-400" [style]="{ textAlign: 'center' }">
              {{ 'orders.noOrders' | translate }}
            </td>
          </tr>
        </ng-template>

        <ng-template #body let-order let-expanded="expanded">
          <tr>
            <td>
              <p-button
                type="button"
                [pRowToggler]="order"
                [text]="true"
                severity="secondary"
                [rounded]="true"
                [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
              />
            </td>

            <td>{{ order.name }}</td>
            <td>{{ order.number }}</td>
            <td>{{ order.date | date:'dd.MM.yyyy' }}</td>
            <td>{{ order.readyDate | date:'dd.MM.yyyy' }}</td>
            <td>{{ order.address }}</td>
            <td>{{ 'delivery.' + order.delivery | translate }}</td>
            <td>{{ 'payment.' + order.payment | translate }}</td>
            <td>{{ order.totalPrice | number:'1.2-2' }} {{ 'currency' | translate }}</td>
          </tr>
        </ng-template>
        
        <ng-template #expandedrow let-order>
          <tr>
            <td colspan="9">
              <div class="p-4">
                <h5 class="mb-3 font-semibold text-lg">
                  {{ 'orders.ingredientsTitle' | translate }}
                </h5>

                <p-table
                  [value]="order.ingredients"
                  dataKey="id"
                  [tableStyle]="{ 'min-width': '40rem' }"
                  class="w-full"
                >
                  <ng-template #header>
                    <tr>
                      <th>{{ 'orders.table.ingredient' | translate }}</th>
                      <th>{{ 'orders.table.pricePer100g' | translate }}</th>
                      <th>{{ 'orders.table.quantity' | translate }}</th>
                    </tr>
                  </ng-template>

                  <ng-template #body let-ingredient>
                    <tr>
                      <td>{{ ingredient.name }}</td>
                      <td>{{ ingredient.price | number:'1.2-2' }} {{ 'currency' | translate }}</td>
                      <td>{{ ingredient.percent }} %</td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </p-card>
</div>
